2023-01-05 11:48:32   AML23-CosPlace/train_only.py --dataset_folder /content/small --groups_num 1 --epochs_num 3 --batch_size 16
2023-01-05 11:48:32   Arguments: Namespace(L=2, M=10, N=5, alpha=30, augmentation_device='cuda', backbone='resnet18', batch_size=16, best_model=None, brightness=0.7, classifiers_lr=0.01, contrast=0.7, dataset_folder='/content/small', device='cuda', epochs_num=3, fc_output_dim=512, groups_num=1, hue=0.5, infer_batch_size=16, iterations_per_epoch=10000, lr=1e-05, min_images_per_class=10, num_workers=8, positive_dist_threshold=25, random_resized_crop=0.5, resume_model=None, resume_train=None, saturation=0.7, save_dir='default', seed=0, test_set_folder='/content/small/test', train_set_folder='/content/small/train', use_amp16=False, val_set_folder='/content/small/val')
2023-01-05 11:48:32   The outputs are being saved in AML23-CosPlace/model/results/best_2023-01-05_11-48-32
2023-01-05 11:48:33   Train only layer3 and layer4 of the resnet18, freeze the previous ones
2023-01-05 11:48:33   There are 1 GPUs and 2 CPUs.
2023-01-05 11:48:35   Using cached dataset cache/small_M10_N5_mipc10.torch
2023-01-05 11:48:35   Using 1 groups
2023-01-05 11:48:35   The 1 groups have respectively the following number of classes [307]
2023-01-05 11:48:35   The 1 groups have respectively the following number of images [3070]
2023-01-05 11:48:35   Start training ...
2023-01-05 11:48:35   There are 307 classes for the first group, each epoch has 10000 iterations with batch_size 16, therefore the model sees each class (on average) 521.2 times per epoch
2023-01-05 11:48:35   Validation set: < val - #q: 7993; #db: 8015 >
2023-01-05 12:44:09   Epoch 00 in 0:55:33, loss = 1.9148
2023-01-05 12:44:09   Extracting database descriptors for evaluation/testing
2023-01-05 12:45:14   Extracting queries descriptors for evaluation/testing using batch size 1
2023-01-05 12:47:06   Calculating recalls
2023-01-05 12:47:08   Epoch 00 in 0:58:32, < val - #q: 7993; #db: 8015 >: R@1: 68.0, R@5: 80.3
2023-01-05 13:44:01   Epoch 01 in 0:56:52, loss = 0.0826
2023-01-05 13:44:01   Extracting database descriptors for evaluation/testing
2023-01-05 13:45:08   Extracting queries descriptors for evaluation/testing using batch size 1
2023-01-05 13:46:56   Calculating recalls
2023-01-05 13:46:58   Epoch 01 in 0:59:49, < val - #q: 7993; #db: 8015 >: R@1: 67.8, R@5: 80.0
2023-01-05 14:43:48   Epoch 02 in 0:56:50, loss = 0.0278
2023-01-05 14:43:48   Extracting database descriptors for evaluation/testing
2023-01-05 14:44:57   Extracting queries descriptors for evaluation/testing using batch size 1
2023-01-05 14:46:45   Calculating recalls
2023-01-05 14:46:46   Epoch 02 in 0:59:48, < val - #q: 7993; #db: 8015 >: R@1: 67.2, R@5: 78.7
2023-01-05 14:46:47   Trained for 03 epochs, in total in 2:58:14
2023-01-05 14:46:47   Best model is saved in AML23-CosPlace/model/results/best_2023-01-05_11-48-32/best_model.pth
2023-01-05 14:46:47   Experiment finished (without any errors)
